<div id="mapid" style="height: 140px; width: 140px;"> </div>

<script id="Js_map" type="text/javascript">
    var map_radius = 13;
  var mymap = L.map('mapid').setView([51.505, -0.09], map_radius);
L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
maxZoom: 18,
// attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
//   'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
id: 'mapbox/streets-v11',
tileSize: 512,
zoomOffset: -1
}).addTo(mymap);
function onMapClick(e) {
  alert("You clicked the map at " + e.latlng);
}
mymap.on('click', onMapClick);
var last_coord = undefined;
var circle = undefined;
var marker = undefined;
function show_position(pos){
console.log("from show_position, last_coord:")
  console.log(last_coord)
mymap.setView([last_coord.latitude, last_coord.longitude],map_radius)
if(circle != undefined)
mymap.removeLayer(circle)//todo: trycatch
  circle = L.circle([last_coord.latitude, last_coord.longitude], {
  color: 'red',
  fillColor: '#f03',
  fillOpacity: 0.5,
  radius: last_coord.accuracy
}).addTo(mymap);
if(marker != undefined)
mymap.removeLayer(marker)
marker=L.marker([last_coord.latitude, last_coord.longitude]).addTo(mymap)
// let accuracy = crd.accuracy

}
function ask_geopos(){
// alert(Geolocation.getCurrentPosition())
function success(pos) {
  var crd = pos.coords;
  last_coord = crd;
  console.log("from ask geopos, last_coord:")
  console.log(last_coord)
  var text = "Current pos:\nLat:"+crd.latitude+"\nLng:"+crd.longitude+"\n+- " + crd.accuracy +" meters";
alert(text);
console.log('Current pos:');
console.log(`Lat: ${crd.latitude}`);
console.log(`Long: ${crd.longitude}`);
console.log(`+- ${crd.accuracy} meters.`);
document.getElementById("my_coords").innerHTML=text;
};
function error(err) {
console.warn(`ERROR(${err.code}): ${err.message}`);
};
var options = {
enableHighAccuracy: true,
timeout: 5000,
maximumAge: 0
};

navigator.geolocation.getCurrentPosition(success, error, options);
}
  </script>