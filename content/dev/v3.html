<html>
<head>
        <script id="gun_cdn_script" src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
        <script id="sea_cdn_script" src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
        <script src="../../js/cdn/ejs.min.js"></script>

</head>
<body>

<div class="container">
<div class="p1" id="p1div">
  <label for="loop_checkbox">Loop</label>  <input type="checkbox" checked onchange="loop_flag=!loop_flag" id="loop_checkbox">
<div id='loop_render'></div>

</div>
<div class="p2" id="p2div">
    <label for="goal_add_name">Goal name</label><input type="text" id="goal_add_name">
    <br>
<p><button onclick="add_goal();">Add goal</button></p>
</div>
<div class="p3" id="p3div">
    <button onclick="
    player1.goals=[];
    update_ls();
    ">Init</button>
</div>
</div>
<script>
var player1={}
player1.skills={cook:true}
player1.state={}
//data provider: (per var)
player1.goals=[{name:'J',solutions:'a',weight:1},{name:'stay healthy', weight:0.7},{name:'learn korean',weight:0.1}]
let solution={related_vars:[
    {name:'a',optimal_state:'a',done_criteria:{one_of:['a','A']}}],human_description:'Some nonsense'}
var loop_flag=true;
//-------------------------------------
function update_ls(){
    localStorage.setItem('goals',JSON.stringify(player1.goals))
}
function load_goals(){
    player1.goals=JSON.parse(localStorage.getItem('goals'));
}
function loop(){
    setTimeout(function(){
        if(loop_flag){
            load_goals();
        let text=`Goals:
        <ul>
        `
        
        player1.goals.forEach((goal,i) => {
            text+='<li>'+goal.name
            if(goal?.solutions)
            ;
            // console.log('solution:',goal.solutions[0] );
            else text+='<button>Problem '+i+', add solution</button>'
            text+='</li>'
        });
        text+='</ul>'
    loop_render.innerHTML=ejs.render(text);
    }
        loop();},700);
}
loop();
var player2={}
player2.state={}
player2.goal={
    stay_productive:{}
}
function empathy(){
    //calc declared (or estimated) goals of another agent 

}
function add_goal(){
player1.goals.push(goal_add_name.value)
update_ls();
}

</script>
<style>
    *{
        margin: 0;
    }
.container{
display: grid;
grid-template-areas: 
/* "header header header" */
 "p1 p2 p3";
/* "p4 p5 ui"; */
grid-template-columns: 1fr 1fr 1fr;
/* grid-template-rows: 0.2fr 2fr 2fr; */
gap: 2px;
height: 100vh;
width: 100vw;
}
.p1{
grid-area: p1;
background-color: pink;
}
.p2{
grid-area: p2;
background-color: hotpink;
}
.p3{
grid-area: p3;
background-color: deeppink;
}
.p4{
grid-area: p4;
background-color: palevioletred;
}
.p5{
grid-area: p5;
background-color: #bb00bb;
}
.ui{
grid-area: ui;
background-color: fuchsia;
}
</style>
</body>
</html>